<html>
<head>

<!-- Load the d3 library. -->
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<style>
body { background-color:#6f6f6f;}
svg { 
border: solid black 1px; }
.axis path { fill: none; stroke: black;}
.axis line { stroke: black; }
text { font-size: small; opacity: 0.3; text-anchor: middle; alignment-baseline: central; }
text:hover { fill: blue; opacity: 1.0; font-weight: bold; font-size: xx-large; }
</style>
</head>
<body>

	<table id="doc"></table>

<!-- leave a spot for the SVG element -->
<div id="canvas"></div>

<script>

var xScale = d3.scale.linear()
  .domain([2008, 2012]).range([50,780]);
var yScale = d3.scale.log()
  .domain([100,26000]).range([750,20]);

var svg = d3.select("#canvas").append("svg")
   .attr("height", 800).attr("width", 800);


var xAxis = d3.svg.axis().scale(xScale);

// The axis consists of multiple SVG elements (a line, tick marks, 
//  and numbers). To keep these together, we'll put them into a <g> group.
svg.append("g")
// The default styles are awful, so we'll give this a class "axis",
//  which we'll use to apply styles from the header.
  .attr("class", "axis")
// The scale function tells the axis where to be in the right-to-left
//  dimension, but not up-and-down. We'll add a transform to shift
//  the whole axis group down to the bottom of the plot.
  .attr("transform", "translate(0, " + yScale(100) + ")")
	// This last part tells the <g> element to apply the xAxis function
	//  that will actually create the axis elements.
  .call(xAxis);

// Now do the same thing for the y scale. The only thing we need
//  to do is change the orientation, to tell d3 to put the tick 
//  marks and numbers to the left of the line.
var yAxis = d3.svg.axis().scale(yScale).orient("left");
svg.append("g")
	.attr("class", "axis")
	.attr("transform", "translate(50, 0)")
	.call(yAxis);

function calculateMaleFemale(file,callback){

	
	var breathTest;
	d3.csv(file, function (data) {
		
	    breathTest = data;
		maleFemale = [0,0]
		breathTest.forEach(function(entry){
			if (entry.Gender == 'Male'){
				maleFemale[0]++;
			}
			else{
				maleFemale[1]++;
			}
			
			})
		callback(maleFemale);
	  });
};

//Reasons = ["Road Traffic Collision", "Suspicion of Alcohol", "Moving Traffic Violation", "Other"]
roadCol = 0;//200882
alcohol = 0;//144274
trafficVio = 0;//230766
others = 0;//75209
wScale = xScale = d3.scale.linear()
  .domain([0, 600000]).range([1,200]);
function drawFigures(file,x,y){
	calculateMaleFemale(file,function(maleFemaleArray){
		//Creates an man icon with size relative to the amount of man's death
		svg.append("image")
		.attr("xlink:href","man-icon-hi.png")
		.attr("width",wScale(maleFemaleArray[0]))
		.attr("height",wScale(maleFemaleArray[0]))
		.attr("x",x)
		.attr("y",y);
		//Creates an woman icon with size relative to the amount of woman's death to be compared with man
		svg.append("image")
		.attr("xlink:href","pink-female-hi.png")
		.attr("width",wScale(maleFemaleArray[1]))
		.attr("height",wScale(maleFemaleArray[1]))
		.attr("x",x)
		.attr("y",y);
		console.log(file);
	});
};
drawFigures("DigitalBreathTestData2009.csv",50,50);
drawFigures("DigitalBreathTestData2010.csv",50,50);
//var maleFemale2010 = calculateMaleFemale("DigitalBreathTestData2010.csv");
//var maleFemale2011 = calculateMaleFemale("DigitalBreathTestData2011.csv");



</script>
</body>
</html>







